name: Verificar rama de origen del Tag

on:
  push:
    tags:
      - 'preview*'  # Este patrón es para cualquier tag que comience con 'preview'

jobs:
  check-branch:
    name: Verificar Rama de Origen del Tag
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repo
        uses: actions/checkout@v3

      - name: Obtener la rama de origen del tag
        run: |
          TAG_NAME=${GITHUB_REF#refs/tags/}
          echo "Tag recibido: $TAG_NAME"

          # Buscar la rama asociada al tag
          BRANCH_NAME=$(git name-rev --name-only $TAG_NAME)
          
          # Mostrar la rama de origen del tag
          echo "El tag $TAG_NAME proviene de la rama $BRANCH_NAME"
          
          # También puedes enviar el mensaje a Discord si lo deseas
          # echo "Tag $TAG_NAME proviene de la rama $BRANCH_NAME" | curl -X POST -H "Content-Type: application/json" \
          # -d "{\"content\": \"Tag $TAG_NAME proviene de la rama $BRANCH_NAME\"}" \
          # $DISCORD_WEBHOOK_URL
